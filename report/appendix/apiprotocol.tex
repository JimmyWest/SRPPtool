\section{Appendix A: Communication API and Protocol}

\subsubsection{Ports}
The server has two listening ports, one for client connections of main links as MainPort and one for client connections of file links as FilePort.
 
\subsubsection{Main communication link}
This is using the server listening port MainPort for connection. 


\begin{table}
\begin{center}
\resizebox{\columnwidth}{!}{%
\begin{tabular}{| p{1.5cm} | p{1.5cm} | p{1.5cm} | p{5cm} | p{1cm} |}
  \hline
  \textbf{Type} & \textbf{Data} & \textbf{Response} & \textbf{Description} & \textbf{Crypt} \\ \hline
  connect & ClientKey & reject or success & Used by the client to connect to the server. & DES \{S\} \\ \hline
  folder & Path & notfound or [content] & Used by the client to retrieve content of a folder, folders and files. & DES3 \{S,C,S\} \\ \hline
  disconnect & \textit{none} & \textit{async} & Used by the client to disconnect from server.  & DES3 \{S,C,S\} \\ \hline

\end{tabular}%
}
\end{center}
\caption{Main communication link API messages.}
\label{tab-mainapi}
\end{table}

\subsubsection{File communication link}
This is using the FilePort for connection. The communication link is a two way communication link, meaning that the client can send messages to the server and the server can send messages to the client. 

\begin{table}
\begin{center}
\resizebox{\columnwidth}{!}{%
\begin{tabular}{| p{1.5cm} | p{1.5cm} | p{1.5cm} | p{5cm} | p{1cm} |}
  \hline
  \textbf{Type} & \textbf{Data} & \textbf{Response} & \textbf{Description} & \textbf{Crypt} \\ \hline
  connect & File ID & reject or notfound or FileKey & Used by the client to connect to setup a new connection to a file. & DES \{S,C,S\} \\ \hline
  content & \textit{none} & reject or content & Used by the client to retrieve a files whole content. & DES3 \{S,C,F\} \\ \hline
  update & Line ID, Line content & reject or success & Used by the client to update the content of a line in the file. & DES3 \{S,C,F\} \\ \hline
  new & Line ID, Line content & reject or success & Used by the client to add a new line after the line ID & DES3 \{S,C,F\} \\ \hline
  remove & Line ID & reject or success & Used by the client to remove the line with a line ID. & DES3 \{S,C,F\} \\ \hline
  cursorpos & Line ID, offset & \textit{async} & Used by the client to tell where it has its cursor. This can be viewed by other clients. & DES3 \{S,C,F\} \\ \hline
  disconnect & \textit{none} & \textit{async} & Used by the client to disconnect & DES3 \{S,C,F\} \\ \hline

\end{tabular}%
}
\end{center}
\caption{File communication link API messages.}
\label{tab-fileapi}
\end{table}

\subsubsection{Message structure}
This is a general description of how the messages are structured. 

\begin{table}
\begin{center}
\resizebox{\columnwidth}{!}{%
\begin{tabular}{| p{1.8cm} | p{1.8cm} | p{5cm} | p{1.8cm} |}
  \hline
  Type:1 byte & Length:1 byte & Data:Length & Fill:0-7 bytes \\ \hline

\end{tabular}%
}
\end{center}
\caption{General message structure of messages sent by both clients and servers.}
\label{tab-msgstruct}
\end{table}

Type is the a id number of which type of message it is. Length is the length of the Data in the message. Data is the data in the message. Fill is used to make the total length of the message will be divisible by 8. 
